<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>Memory Path</title>
		<link rel="stylesheet" type="text/css" href="style.css">
		<script>
			var numOfTileInCol;
			var usedValuesIncol = [];
			var k =0;
			var path=[];
			var pointer;
			var startPoint;
			var input = 5;
			var path = [];
			var tiles = [];
			var col = [];
			var direction;
			var randomNumber;
			var isMatched = false;
			//generate a right size of grid based on user input
			function generatedPath(){
				var table = document.getElementById("grid");
				var tbody = document.createElement("tbody");
				var row,column;
				var i;
				var counter = 1;
				for(i=1;i<=input;i++){
					row = document.createElement("tr");
					for(var j=1;j<=input;j++){
						column = document.createElement("td");
						column.setAttribute("id",counter);
						counter++;
						column.style.background="yellow";
						row.appendChild(column);
						tiles.push(column);
					}
					tbody.appendChild(row);
				}
				table.appendChild(tbody);
			}
			//provide randomized path
			function randomizedPath(){
				counter =1;
				 //put tiles in the same column to a array 
				 // to use functions.
				 while(counter <=input){
						for(var j=0;j<tiles.length;j++){
							if(parseInt(tiles[j].id)%input==counter){
								col.push(tiles[j]);
							}
							if(counter==input&&parseInt(tiles[j].id)%input==0){
								col.push(tiles[j]);	
							}
						}

					if(counter==1){
						determineFirstCol(col);
					}else{
						determineOtherCol(col);
					}
					counter++;
					col = [];
				 }
			}
			//
			function determineFirstCol(array){
				numOfTileInCol = parseInt(Math.random()*3+1);
				col = array.slice(0);
				if(numOfTileInCol==1){
					startPoint = parseInt(Math.random()*input);
					col[startPoint].style.background="green";
					pointer = startPoint;
					path.push(col[startPoint]);
				}else if(numOfTileInCol==2){
					startPoint = parseInt(Math.random()*(input-1));
					col[startPoint].style.background="green";
					col[startPoint+1].style.background="green";
					direction = parseInt(Math.random()*2);
					if(direction ==0){
						pointer = startPoint;
						path.push(col[startPoint+1]);
						path.push(col[startPoint]);
					}else{
						pointer = startPoint + 1;
						path.push(col[startPoint]);
						path.push(col[startPoint+1]);
					}

				}else{
					startPoint = parseInt(Math.random()*(input-2));
					col[startPoint].style.background="green";
					col[startPoint+1].style.background="green";
					col[startPoint+2].style.background="green";
					direction = parseInt(Math.random()*2);
					if(direction ==0){
						pointer = startPoint;
						path.push(col[startPoint+2]);
						path.push(col[startPoint+1]);
						path.push(col[startPoint]);
					}else{
						pointer = startPoint+2;
						path.push(col[startPoint]);
						path.push(col[startPoint+1]);
						path.push(col[startPoint+2]);
					}
				}
				col = [];
			}
			function determineOtherCol(array){
				numOfTileInCol = parseInt(Math.random()*3+1);
				col = array.slice(0);
				if(numOfTileInCol==1){
					col[pointer].style.background="green";
					path.push(col[pointer]);
				}else if(numOfTileInCol==2){
					while(!isMatched){
						randomNumber = parseInt(Math.random()*4);
						if(randomNumber==pointer  && randomNumber+1 <=(input-1)|| randomNumber+1==pointer && randomNumber+1 <=(input-1)){
							isMatched = true;
						}
					}
					isMatched = false;
					for(i=0;i<numOfTileInCol;i++){
						usedValuesIncol[i] = randomNumber + i;
					}
					for(i=0;i<usedValuesIncol.length;i++){
						col[usedValuesIncol[i]].style.background="green";
					}
					if(randomNumber==pointer){
						col[usedValuesIncol[1]].style.background="green";
						pointer = usedValuesIncol[1];
						path.push(col[pointer+1]);
						path.push(col[pointer]);
					}else{
						col[usedValuesIncol[0]].style.background="green";
						pointer = usedValuesIncol[0];
						path.push(col[pointer]);
						path.push(col[pointer+1]);
					}
				}else{
					while(!isMatched){
						randomNumber = parseInt(Math.random()*3);
						if(randomNumber==pointer && randomNumber+2 <=(input-1) || randomNumber+2==pointer && randomNumber+2 <=(input-1)){
							isMatched = true;
						}
					}
					isMatched = false;
					for(i=0;i<numOfTileInCol;i++){
						usedValuesIncol[i] = randomNumber + i;
					}
					for(i=0; i<numOfTileInCol;i++){
						col[usedValuesIncol[i]].style.background="green";
					}
					if(randomNumber ==pointer){
						col[usedValuesIncol[usedValuesIncol.length-1]].style.background="green";
						pointer = usedValuesIncol[usedValuesIncol.length-1];
						path.push(col[pointer+2]);
						path.push(col[pointer+1]);
						path.push(col[pointer]);
					}else{
						col[usedValuesIncol[0]].style.background="green";
						pointer = usedValuesIncol[0];
						path.push(col[pointer]);
						path.push(col[pointer+1]);
						path.push(col[pointer+2]);
					}
				}
				usedValuesIncol = [];
				col = [];
			}
		function drawPath(){
			for(i=0;i<path.length;i++){
				path[i].style.background="green";
			}
		}
		window.addEventListener("load", generatedPath, false);
		window.addEventListener("load", randomizedPath, false);	
		
		</script>
	</head>
	<body>
		
		<table id="grid"></table>
	</body>
</html>