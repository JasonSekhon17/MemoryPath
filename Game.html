<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>Memory Path</title>
		<link rel="stylesheet" type="text/css" href="style.css">
		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0-beta1/jquery.min.js"></script>
		<script>

      var pathArray;
      var gridArray;
      var size;
      var correct = 0;


      function displayGrid() {
          window.size = document.getElementById('grid').rows.length;

          window.gridArray = new Array(window.size);
          for (var i = 0; i < window.size; i++) {
              window.gridArray[i] = new Array(window.size);
              for (var j = 0; j < window.size; j++) {
                  window.gridArray[i][j] = '';
              }
          }
          hardcodePath();
          setTimeout("inputGrid()", 3000);
      }

      function hardcodePath() {
          window.pathArray = ["3 0", "3 1", "2 1", "1 1", "1 2", "1 3", "2 3", "2 4"];
          var y = document.getElementById('grid');
          var row;
          var col;
          var str;
          for (i = 0; i < window.size; i++) {
              for (j = 0; j < window.size; j++) {
                  var cell = y.rows[i].cells[j];
                  cell.innerHTML = '';
              }
          }

          for (i = 0; i < window.pathArray.length; i++) {
              str = window.pathArray[i];
              row = parseInt(str.substring(0, 1));
              col = parseInt(str.substring(2, 3));
              y.rows[row].cells[col].style.backgroundColor = 'white';
              window.gridArray[row][col] = 1;
              y.rows[row].cells[col].className += ' step' + i;
          }


      }

      function inputGrid() {
          var x = document.getElementById('grid').rows.length;
          var y = document.getElementById('grid');

          for (i = 0; i < x; i++) {
              for (j = 0; j < x; j++) {
                  var cell = y.rows[i].cells[j];
                  cell.className += ' row' + i + ' col' + j;
                  cell.style.backgroundColor = "#0070c0";
              }
          }
      }


      /** validates the user's path **/

      /** checks for wrong answers in each tile and refreshes page. Will lead to game over screen or remove a life in later versions **/
      function checkWrong() {
          var y = document.getElementById('grid');
          var row;
          var col;
          var str;
          for (i = 0; i < window.size; i++) {
              for (j = 0; j < window.size; j++) {
                  var cell = y.rows[i].cells[j];
                  if ($(cell).hasClass("wrong")) {
                      window.location.reload;
                  }
              }
          }
      }


      /** checks if the user has the correct path **/
      function checkCorrect() {
          var y = document.getElementById('grid');
          var row;
          var col;
          var str;
          var amount = 0; //to be incremented whenever the user gets a correct answer
          for (i = 0; i < window.size; i++) {
              for (j = 0; j < window.size; j++) {
                  var cell = y.rows[i].cells[j];
                  if ($(cell).hasClass("correct")) {
                      amount++;
                  }
                  if (amount == window.pathArray.length) {
                      window.location.reload;
                  }
              }
          }
      }


      /** Mouse events **/
      $(document).ready(function () {

          var isDown = false;

          $(document).mousedown(function () {
              isDown = true;      // When mouse goes down, set isDown to true
          })

          $(document).mouseup(function () {
              isDown = false;    // When mouse goes up, set isDown to false
          });
          $("td").mouseover(function () {
              if (isDown) {
                  if ($(this).hasClass("step" + window.correct)) {
                      $(this).css("background-color", "green");
                      $(this).addClass("correct");
                      window.correct++;
                      window.checkCorrect();
                  } else {
                      $(this).css("background-color", "red");
                      $(this).addClass("wrong");
                      window.checkWrong();
                  }
              }
          });
          $("td").mousedown(function () {
              if ($(this).hasClass("step" + window.correct)) {
                  $(this).css("background-color", "green");
                  $(this).addClass("correct");
                  window.correct++;
                  window.checkCorrect();
              } else {
                  $(this).css("background-color", "red");
                  $(this).addClass("wrong");
                  window.checkWrong();
              }
          });

          $("td").dblclick(function () {
              $(this).css("background-color", "yellow");
          });

      });

		</script>
	</head>
	<body onload="displayGrid()" onmousedown="event.preventDefault ? event.preventDefault() : event.returnValue = false">
		<div id="test"></div>
		<table id="grid">
			<tr>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
		</table>
	</body>
</html>